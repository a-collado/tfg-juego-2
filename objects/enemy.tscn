[gd_scene load_steps=16 format=3 uid="uid://dx3yfr7vp3gbn"]

[ext_resource type="PackedScene" uid="uid://nklwmh4e4jwg" path="res://objects/player.tscn" id="1_djgfh"]
[ext_resource type="Script" path="res://scripts/enemy/enemy.gd" id="2_mtiaa"]
[ext_resource type="Script" path="res://addons/StateMachine/state_machine.gd" id="3_03ql3"]
[ext_resource type="Shader" uid="uid://rmua1fkabo1e" path="res://assets/Shaders/3D/bat_trail.tres" id="3_yyxms"]
[ext_resource type="Script" path="res://scripts/enemy/states/defend.gd" id="4_4o8ek"]
[ext_resource type="Texture2D" uid="uid://027637t71n23" path="res://assets/Modelos 3D/trail/trail_textura_text.png" id="4_ynvwr"]
[ext_resource type="Script" path="res://scripts/enemy/states/idle.gd" id="6_i74hs"]
[ext_resource type="Script" path="res://scripts/enemy/states/charge.gd" id="9_jc1lt"]
[ext_resource type="Script" path="res://scripts/enemy/states/attack.gd" id="9_rudlm"]

[sub_resource type="BoxShape3D" id="BoxShape3D_p8lqk"]
size = Vector3(2.52759, 1.60049, 0.399414)

[sub_resource type="BoxShape3D" id="BoxShape3D_fsbx3"]
size = Vector3(2.18945, 1.60049, 2.20215)

[sub_resource type="BoxShape3D" id="BoxShape3D_tl0he"]
size = Vector3(1.75195, 1.60049, 0.96582)

[sub_resource type="BoxShape3D" id="BoxShape3D_oht2c"]
size = Vector3(1.21863, 2.35437, 1)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_o7eui"]
resource_local_to_scene = true
render_priority = 0
shader = ExtResource("3_yyxms")
shader_parameter/progress = 0.0
shader_parameter/Texture = ExtResource("4_ynvwr")

[sub_resource type="ViewportTexture" id="ViewportTexture_brdgy"]
viewport_path = NodePath("hitManager/SubViewport")

[node name="Enemy" instance=ExtResource("1_djgfh")]
transform = Transform3D(6.98928, 0, 0, 0, 6.98928, 0, 0, 0, 6.98928, 0, 0, 0)
script = ExtResource("2_mtiaa")

[node name="Skeleton3D" parent="root" index="0"]
bones/2/position = Vector3(0.000191063, 0.0162169, -0.000324203)
bones/2/rotation = Quaternion(-0.0416384, -0.368436, -0.0122781, 0.928639)
bones/3/position = Vector3(0, 0.0042981, -0.000164561)
bones/3/rotation = Quaternion(0.0467609, 0.0391916, -0.0103957, 0.998083)
bones/4/position = Vector3(0, 0.00151199, 9.11349e-12)
bones/4/rotation = Quaternion(0.093098, 0.0808864, -0.0169039, 0.992222)
bones/5/position = Vector3(0, 0.00194611, 2.35371e-11)
bones/5/rotation = Quaternion(0.0806152, 0.0811159, -0.0159048, 0.993312)
bones/6/position = Vector3(2.46323e-21, 0.00785639, 1.5784e-05)
bones/6/rotation = Quaternion(0.012449, -0.011049, 0.00137901, 0.999861)
bones/7/position = Vector3(-8.35262e-24, 0.00306916, 9.04366e-05)
bones/7/rotation = Quaternion(0.00632123, 0.175646, -0.0199855, 0.98423)
bones/7/scale = Vector3(1, 1, 1)
bones/8/position = Vector3(-3.54111e-19, 0.0203936, 0.000945564)
bones/8/rotation = Quaternion(-0.0692872, 9.9839e-26, -2.26841e-24, 0.997597)
bones/9/position = Vector3(0.0114219, 0.0086299, -0.00218568)
bones/9/rotation = Quaternion(0.405064, 0.457981, -0.593572, 0.523306)
bones/9/scale = Vector3(1, 1, 1)
bones/10/position = Vector3(-0.0114219, 0.0086299, -0.00218568)
bones/10/rotation = Quaternion(0.405064, -0.457981, 0.593572, 0.523306)
bones/10/scale = Vector3(1, 1, 1)
bones/11/position = Vector3(0.00515354, 0.0061933, -0.00095877)
bones/11/rotation = Quaternion(0.465299, 0.522071, -0.504294, 0.506583)
bones/11/scale = Vector3(1, 1, 1)
bones/12/position = Vector3(1.12093e-10, 0.00159296, 1.49442e-09)
bones/12/rotation = Quaternion(0.59543, -0.0967247, 0.00420534, 0.797552)
bones/12/scale = Vector3(1, 1, 1)
bones/13/position = Vector3(-4.91316e-10, 0.00668584, -3.76568e-09)
bones/13/rotation = Quaternion(0.0271333, 0.0566459, 0.419066, 0.905781)
bones/13/scale = Vector3(1, 1, 1)
bones/14/position = Vector3(-1.066e-09, 0.00715189, -1.06656e-08)
bones/14/rotation = Quaternion(-0.155537, 0.182174, -0.009046, 0.970845)
bones/14/scale = Vector3(1, 1, 1)
bones/15/position = Vector3(-0.0019131, 0.00138919, 0.00032659)
bones/15/rotation = Quaternion(0.264147, 0.213056, 0.253836, 0.90576)
bones/15/scale = Vector3(1, 1, 1)
bones/16/position = Vector3(9.473e-05, 0.00163097, 5.61801e-08)
bones/16/rotation = Quaternion(-0.00082093, 0.134352, -0.0321087, 0.990413)
bones/16/scale = Vector3(1, 1, 1)
bones/17/position = Vector3(5.05072e-10, 0.00261986, 3.36532e-10)
bones/17/rotation = Quaternion(4.73019e-08, 0.0435342, -1.1627e-08, 0.999052)
bones/17/scale = Vector3(1, 1, 1)
bones/18/position = Vector3(-1.74844e-09, 0.00245541, -2.47052e-10)
bones/18/rotation = Quaternion(0.0200672, -0.0409322, -0.0145046, 0.998855)
bones/18/scale = Vector3(1, 1, 1)
bones/19/position = Vector3(-0.00253738, 0.00469962, -0.000221968)
bones/19/rotation = Quaternion(0.0450642, -0.027702, 0.0908997, 0.994454)
bones/19/scale = Vector3(1, 1, 1)
bones/20/position = Vector3(-5.73255e-10, 0.00262178, -1.2848e-08)
bones/20/rotation = Quaternion(0.153896, 0.00414944, -0.0110264, 0.988017)
bones/20/scale = Vector3(1, 1, 1)
bones/21/position = Vector3(4.62254e-10, 0.00214142, -1.24657e-13)
bones/21/rotation = Quaternion(-2.91038e-11, 1.02459e-17, 3.52048e-07, 1)
bones/22/position = Vector3(8.25963e-10, 0.000897824, 6.93889e-18)
bones/22/rotation = Quaternion(0.0444882, -1.56697e-08, -3.51872e-07, 0.99901)
bones/23/position = Vector3(-0.000311274, 0.00507147, -4.9075e-05)
bones/23/rotation = Quaternion(0.131462, -0.0241343, -0.0429862, 0.990095)
bones/23/scale = Vector3(1, 1, 1)
bones/24/position = Vector3(-4.57832e-10, 0.00260657, -3.04952e-09)
bones/24/rotation = Quaternion(0.203622, 0.0119342, 0.00738487, 0.978949)
bones/24/scale = Vector3(1, 1, 1)
bones/25/position = Vector3(2.05524e-06, 0.00222416, -3.56135e-07)
bones/25/rotation = Quaternion(-1.35635e-06, -0.00292555, -0.000449612, 0.999996)
bones/25/scale = Vector3(1, 1, 1)
bones/26/position = Vector3(-4.965e-11, 0.000752133, -4.44355e-09)
bones/26/rotation = Quaternion(0.0105553, 0.00286095, 0.00286106, 0.999936)
bones/27/position = Vector3(0.00202074, 0.00494113, -0.000193294)
bones/27/rotation = Quaternion(0.297014, -0.0292651, -0.122754, 0.946498)
bones/28/position = Vector3(-6.77258e-10, 0.00275274, -3.42259e-07)
bones/28/rotation = Quaternion(0.350059, 0.0118933, 0.0392312, 0.93583)
bones/28/scale = Vector3(1, 1, 1)
bones/29/position = Vector3(1.34437e-09, 0.00223389, -2.7266e-09)
bones/29/rotation = Quaternion(-4.07365e-10, -7.63062e-17, -1.87317e-07, 1)
bones/30/position = Vector3(7.29523e-11, 0.000976562, 0)
bones/30/rotation = Quaternion(0.0445194, 3.12896e-09, 7.02133e-08, 0.999009)
bones/30/scale = Vector3(1, 1, 1)
bones/31/position = Vector3(-0.00515354, 0.0061933, -0.00095877)
bones/31/rotation = Quaternion(0.512597, -0.47477, 0.477127, 0.533093)
bones/31/scale = Vector3(1, 1, 1)
bones/32/position = Vector3(-1.12093e-10, 0.00159296, 1.49442e-09)
bones/32/rotation = Quaternion(0.54047, 0.0609879, 0.219151, 0.810028)
bones/32/scale = Vector3(1, 1, 1)
bones/33/position = Vector3(4.91316e-10, 0.00668584, -3.76568e-09)
bones/33/rotation = Quaternion(0.0937763, 0.0208958, -0.359387, 0.92823)
bones/33/scale = Vector3(1, 1, 1)
bones/34/position = Vector3(1.066e-09, 0.00715189, -1.06656e-08)
bones/34/rotation = Quaternion(0.0996545, -0.0874271, -0.0148332, 0.991063)
bones/34/scale = Vector3(1, 1, 1)
bones/35/position = Vector3(0.0019131, 0.00138919, 0.00032659)
bones/35/rotation = Quaternion(0.173869, -0.0742223, -0.301832, 0.934429)
bones/35/scale = Vector3(1, 1, 1)
bones/36/position = Vector3(-9.473e-05, 0.00163097, 5.61801e-08)
bones/36/rotation = Quaternion(0.0702752, -0.127375, 0.201536, 0.968618)
bones/36/scale = Vector3(1, 1, 1)
bones/37/position = Vector3(-5.05072e-10, 0.00261986, 3.36532e-10)
bones/37/rotation = Quaternion(-8.84919e-08, -0.0435343, 3.14176e-08, 0.999052)
bones/37/scale = Vector3(1, 1, 1)
bones/38/position = Vector3(1.74844e-09, 0.00245541, -2.47052e-10)
bones/38/rotation = Quaternion(0.0200672, 0.0409322, 0.0145046, 0.998855)
bones/38/scale = Vector3(1, 1, 1)
bones/39/position = Vector3(0.00253738, 0.00469962, -0.000221968)
bones/39/rotation = Quaternion(0.0359336, 0.0319989, -0.0217584, 0.998605)
bones/39/scale = Vector3(1, 1, 1)
bones/40/position = Vector3(5.73255e-10, 0.00262178, -1.2848e-08)
bones/40/rotation = Quaternion(0.144984, -0.00511553, 0.0151087, 0.989305)
bones/40/scale = Vector3(1, 1, 1)
bones/41/position = Vector3(-4.62254e-10, 0.00214142, -1.24657e-13)
bones/41/rotation = Quaternion(-2.91038e-11, -1.02459e-17, -3.52048e-07, 1)
bones/42/position = Vector3(-8.25963e-10, 0.000897824, 6.93889e-18)
bones/42/rotation = Quaternion(0.0444882, 1.56697e-08, 3.51872e-07, 0.99901)
bones/43/position = Vector3(0.000311274, 0.00507147, -4.9075e-05)
bones/43/rotation = Quaternion(0.106903, 0.0360186, -0.0025561, 0.993614)
bones/43/scale = Vector3(1, 1, 1)
bones/44/position = Vector3(4.57832e-10, 0.00260657, -3.04952e-09)
bones/44/rotation = Quaternion(0.298724, -0.0113331, -0.00757629, 0.954242)
bones/44/scale = Vector3(1, 1, 1)
bones/45/position = Vector3(-2.05524e-06, 0.00222416, -3.56135e-07)
bones/45/rotation = Quaternion(-1.35271e-06, 0.00292566, 0.000449672, 0.999996)
bones/45/scale = Vector3(1, 1, 1)
bones/46/position = Vector3(4.965e-11, 0.000752133, -4.44355e-09)
bones/46/rotation = Quaternion(0.0105553, -0.00286095, -0.00286106, 0.999936)
bones/47/position = Vector3(-0.00202074, 0.00494113, -0.000193294)
bones/47/rotation = Quaternion(0.201639, 0.000413677, 0.0646909, 0.977321)
bones/48/position = Vector3(6.77258e-10, 0.00275274, -3.42259e-07)
bones/48/rotation = Quaternion(0.36794, -0.0130745, -0.0587457, 0.9279)
bones/48/scale = Vector3(1, 1, 1)
bones/49/position = Vector3(-1.34437e-09, 0.00223389, -2.7266e-09)
bones/49/rotation = Quaternion(-4.07365e-10, 7.63062e-17, 1.87317e-07, 1)
bones/50/position = Vector3(-7.29523e-11, 0.000976562, 0)
bones/50/rotation = Quaternion(0.0445194, -3.12896e-09, -7.02133e-08, 0.999009)
bones/50/scale = Vector3(1, 1, 1)
bones/51/position = Vector3(0.00469643, -9.78088e-05, 6.2666e-05)
bones/51/rotation = Quaternion(0.0706718, 0.234507, 0.962561, -0.116137)
bones/51/scale = Vector3(1.00003, 1, 1)
bones/52/position = Vector3(1.50464e-08, 0.00795514, -5.9199e-11)
bones/52/rotation = Quaternion(-0.3085, 0.126898, -0.0172906, 0.942564)
bones/52/scale = Vector3(1, 1, 1)
bones/53/position = Vector3(-5.45236e-09, 0.00703207, -6.26224e-10)
bones/53/rotation = Quaternion(0.569745, -0.0545616, -0.057913, 0.817961)
bones/53/scale = Vector3(1, 1, 1)
bones/54/position = Vector3(9.27365e-08, 0.00596507, 1.6596e-08)
bones/54/rotation = Quaternion(0.192078, -0.0172975, 0.0981889, 0.976302)
bones/54/scale = Vector3(1, 0.999996, 0.999999)
bones/55/position = Vector3(4.74959e-09, 0.00236276, 4.74038e-09)
bones/55/rotation = Quaternion(0.0457375, -0.0394311, -0.0727503, 0.99552)
bones/55/scale = Vector3(1, 1, 1)
bones/56/position = Vector3(-0.00469643, -9.78088e-05, 6.2666e-05)
bones/56/rotation = Quaternion(-0.133464, -0.0922759, 0.978617, 0.126418)
bones/56/scale = Vector3(1.00003, 1, 1)
bones/57/position = Vector3(-1.50464e-08, 0.00795514, -5.9199e-11)
bones/57/rotation = Quaternion(-0.229558, 0.0593472, -0.0747536, 0.968604)
bones/57/scale = Vector3(1, 1, 1)
bones/58/position = Vector3(5.45236e-09, 0.00703207, -6.26224e-10)
bones/58/rotation = Quaternion(0.700975, 0.129923, 0.150265, 0.684963)
bones/58/scale = Vector3(1, 1, 1)
bones/59/position = Vector3(-9.27365e-08, 0.00596507, 1.6596e-08)
bones/59/rotation = Quaternion(0.184558, 0.0354208, -0.124757, 0.974228)
bones/59/scale = Vector3(1, 0.999996, 0.999999)
bones/60/position = Vector3(-4.74959e-09, 0.00236276, 4.74038e-09)
bones/60/rotation = Quaternion(0.0457375, 0.0394311, 0.0727503, 0.99552)
bones/60/scale = Vector3(1, 1, 1)

[node name="CollisionShape3D" parent="hitNodes/hitArea" index="0"]
shape = SubResource("BoxShape3D_p8lqk")

[node name="CollisionShape3D2" parent="hitNodes/hitArea" index="1"]
shape = SubResource("BoxShape3D_fsbx3")

[node name="CollisionShape3D3" parent="hitNodes/hitArea" index="2"]
shape = SubResource("BoxShape3D_tl0he")

[node name="CollisionShape3D5" parent="hitNodes/hitArea" index="3"]
shape = SubResource("BoxShape3D_tl0he")

[node name="CollisionShape3D4" parent="hitNodes/hitArea" index="4"]
shape = SubResource("BoxShape3D_p8lqk")

[node name="CollisionShape3D6" type="CollisionShape3D" parent="hitNodes/hitArea" index="5"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0186736, 0.677185, -0.0816349)
shape = SubResource("BoxShape3D_oht2c")

[node name="hitPredictionArea" type="Area3D" parent="hitNodes" index="1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0167713, 0, 0.145831)
collision_layer = 0
collision_mask = 16

[node name="CollisionShape3D" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="0"]
transform = Transform3D(0.917164, 0, -0.398509, 0, 1, 0, 0.398509, 0, 0.917164, 0.91968, 0.812524, 0.497738)
shape = SubResource("BoxShape3D_p8lqk")

[node name="CollisionShape3D2" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="1"]
transform = Transform3D(0.999692, 0, -0.0248335, 0, 1, 0, 0.0248335, 0, 0.999692, 0.0037188, 0.812524, 0.961651)
shape = SubResource("BoxShape3D_fsbx3")

[node name="CollisionShape3D3" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="2"]
transform = Transform3D(0.651979, 0, 0.758237, 0, 1, 0, -0.758237, 0, 0.651979, -0.964785, 0.812524, 1.0705)
shape = SubResource("BoxShape3D_tl0he")

[node name="CollisionShape3D4" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="3"]
transform = Transform3D(0.65096, 0, -0.759112, 0, 1, 0, 0.759112, 0, 0.65096, 0.932687, 0.805996, 1.06904)
shape = SubResource("BoxShape3D_tl0he")

[node name="CollisionShape3D5" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="4"]
transform = Transform3D(-0.914028, 0, -0.405652, 0, 1, 0, 0.405652, 0, -0.914028, -0.936635, 0.812524, 0.524693)
shape = SubResource("BoxShape3D_p8lqk")

[node name="CollisionShape3D7" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="5"]
transform = Transform3D(1, 0, 3.4112e-08, 0, 1, 0, -3.4112e-08, 0, 1, 0.0186738, 0.677185, -0.081635)
shape = SubResource("BoxShape3D_oht2c")

[node name="Trail" parent="hitNodes/hitDirection" index="0"]
material_override = SubResource("ShaderMaterial_o7eui")

[node name="Bate" parent="hitNodes" index="3"]
transform = Transform3D(10.0945, -3.97776, -20.9411, 2.88143, 23.2126, -3.02028, 21.1199, -1.26572, 10.4211, -0.496312, 0.65825, 0.332235)

[node name="AnimationTree" parent="animationManager" index="0"]
parameters/conditions/hit_ball = false
parameters/bat/TimeScale/scale = 1.0

[node name="stateMachine" type="Node" parent="." index="4" node_paths=PackedStringArray("initial_state")]
script = ExtResource("3_03ql3")
initial_state = NodePath("Idle")

[node name="Defend" type="Node" parent="stateMachine" index="0"]
script = ExtResource("4_4o8ek")

[node name="Idle" type="Node" parent="stateMachine" index="1"]
script = ExtResource("6_i74hs")

[node name="Attack" type="Node" parent="stateMachine" index="2"]
script = ExtResource("9_rudlm")

[node name="Charge" type="Node" parent="stateMachine" index="3"]
script = ExtResource("9_jc1lt")

[node name="navigationAgent" type="NavigationAgent3D" parent="." index="5"]
path_desired_distance = 2.0

[node name="Sprite3D" parent="hitManager" index="1"]
texture = SubResource("ViewportTexture_brdgy")

[connection signal="area_entered" from="hitNodes/hitPredictionArea" to="stateMachine/Attack" method="_on_hit_prediction_area_area_entered"]
[connection signal="reset_prediction_area" from="stateMachine/Attack" to="." method="_on_attack_reset_prediction_area"]

[editable path="root"]
