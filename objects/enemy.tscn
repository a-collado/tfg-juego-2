[gd_scene load_steps=16 format=3 uid="uid://dx3yfr7vp3gbn"]

[ext_resource type="PackedScene" uid="uid://nklwmh4e4jwg" path="res://objects/player.tscn" id="1_djgfh"]
[ext_resource type="Script" path="res://scripts/enemy/enemy.gd" id="2_mtiaa"]
[ext_resource type="Script" path="res://addons/StateMachine/state_machine.gd" id="3_03ql3"]
[ext_resource type="Script" path="res://scripts/enemy/navigator.gd" id="3_m6isb"]
[ext_resource type="Shader" uid="uid://rmua1fkabo1e" path="res://assets/Shaders/3D/bat_trail.tres" id="3_yyxms"]
[ext_resource type="Script" path="res://scripts/enemy/states/defend.gd" id="4_4o8ek"]
[ext_resource type="Texture2D" uid="uid://027637t71n23" path="res://assets/Modelos 3D/trail/trail_textura_text.png" id="4_ynvwr"]
[ext_resource type="Script" path="res://scripts/enemy/states/idle.gd" id="6_i74hs"]
[ext_resource type="Script" path="res://scripts/enemy/states/attack.gd" id="9_rudlm"]

[sub_resource type="BoxShape3D" id="BoxShape3D_p8lqk"]
size = Vector3(2.52759, 1.60049, 0.399414)

[sub_resource type="BoxShape3D" id="BoxShape3D_fsbx3"]
size = Vector3(2.18945, 1.60049, 2.20215)

[sub_resource type="BoxShape3D" id="BoxShape3D_tl0he"]
size = Vector3(1.75195, 1.60049, 0.96582)

[sub_resource type="BoxShape3D" id="BoxShape3D_iq5ta"]
size = Vector3(1, 1.73242, 1)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_o7eui"]
resource_local_to_scene = true
render_priority = 0
shader = ExtResource("3_yyxms")
shader_parameter/progress = 0.0
shader_parameter/Texture = ExtResource("4_ynvwr")

[sub_resource type="ViewportTexture" id="ViewportTexture_brdgy"]
viewport_path = NodePath("hitManager/SubViewport")

[node name="Enemy" instance=ExtResource("1_djgfh")]
transform = Transform3D(6.98928, 0, 0, 0, 6.98928, 0, 0, 0, 6.98928, 0, 0, 0)
script = ExtResource("2_mtiaa")

[node name="CollisionShape3D" parent="hitNodes/hitArea" index="0"]
shape = SubResource("BoxShape3D_p8lqk")

[node name="CollisionShape3D2" parent="hitNodes/hitArea" index="1"]
shape = SubResource("BoxShape3D_fsbx3")

[node name="CollisionShape3D3" parent="hitNodes/hitArea" index="2"]
shape = SubResource("BoxShape3D_tl0he")

[node name="CollisionShape3D5" parent="hitNodes/hitArea" index="3"]
shape = SubResource("BoxShape3D_tl0he")

[node name="CollisionShape3D4" parent="hitNodes/hitArea" index="4"]
shape = SubResource("BoxShape3D_p8lqk")

[node name="hitPredictionArea" type="Area3D" parent="hitNodes" index="1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0167713, 0, 0.145831)
collision_layer = 0
collision_mask = 16

[node name="CollisionShape3D" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="0"]
transform = Transform3D(0.917164, 0, -0.398509, 0, 1, 0, 0.398509, 0, 0.917164, 0.91968, 0.812524, 0.497738)
shape = SubResource("BoxShape3D_p8lqk")

[node name="CollisionShape3D2" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="1"]
transform = Transform3D(0.999692, 0, -0.0248335, 0, 1, 0, 0.0248335, 0, 0.999692, 0.0037188, 0.812524, 0.961651)
shape = SubResource("BoxShape3D_fsbx3")

[node name="CollisionShape3D3" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="2"]
transform = Transform3D(0.651979, 0, 0.758237, 0, 1, 0, -0.758237, 0, 0.651979, -0.964785, 0.812524, 1.0705)
shape = SubResource("BoxShape3D_tl0he")

[node name="CollisionShape3D5" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="3"]
transform = Transform3D(0.65096, 0, -0.759112, 0, 1, 0, 0.759112, 0, 0.65096, 0.932687, 0.805996, 1.06904)
shape = SubResource("BoxShape3D_tl0he")

[node name="CollisionShape3D4" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="4"]
transform = Transform3D(-0.914028, 0, -0.405652, 0, 1, 0, 0.405652, 0, -0.914028, -0.936635, 0.812524, 0.524693)
shape = SubResource("BoxShape3D_p8lqk")

[node name="CollisionShape3D6" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="5"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.853195, 0.0500158)
shape = SubResource("BoxShape3D_iq5ta")

[node name="Trail" parent="hitNodes/hitDirection" index="0"]
material_override = SubResource("ShaderMaterial_o7eui")

[node name="Bate" parent="hitNodes" index="3"]
transform = Transform3D(10.0945, -3.97776, -20.9411, 2.88143, 23.2126, -3.02028, 21.1199, -1.26572, 10.4211, -0.496312, 0.65825, 0.332235)

[node name="Skeleton3D" parent="root" index="0"]
bones/0/position = Vector3(0.00373457, 0.829819, 0.210573)
bones/0/rotation = Quaternion(-0.0679639, 0.393167, -0.0115806, 0.916879)
bones/1/rotation = Quaternion(0.602559, 0.0783989, 0.793702, -0.0285029)
bones/1/scale = Vector3(1, 1.02288, 1)
bones/2/rotation = Quaternion(-3.03044e-05, 3.7099e-05, 0.405283, 0.914191)
bones/3/rotation = Quaternion(0.430568, 0.44692, -0.464777, 0.63155)
bones/3/scale = Vector3(0.998302, 0.995513, 0.985938)
bones/4/position = Vector3(0.00119071, 0.127566, -0.00301069)
bones/4/rotation = Quaternion(0.106439, 0.930671, 0.349765, -0.01364)
bones/4/scale = Vector3(0.999927, 0.991082, 1.00879)
bones/5/rotation = Quaternion(0.877805, -0.265242, -0.392275, 0.0722924)
bones/6/rotation = Quaternion(-2.661e-06, -1.29998e-06, 0.492329, -0.870409)
bones/7/rotation = Quaternion(0.351564, -0.690766, 0.417654, 0.474142)
bones/8/rotation = Quaternion(-0.049485, 0.861809, 0.504591, -0.0149638)
bones/9/rotation = Quaternion(0.0804417, -0.40124, 0.00539842, 0.912418)
bones/10/rotation = Quaternion(0.144747, 0.0614996, -0.0253641, 0.98723)
bones/12/rotation = Quaternion(-0.338044, -0.0418423, 0.0397897, 0.939358)
bones/13/rotation = Quaternion(-0.532274, 0.550758, -0.448348, -0.460798)
bones/14/rotation = Quaternion(0.484773, 0.829473, 0.106493, 0.25618)
bones/15/rotation = Quaternion(0.617373, 0.019507, 0.29888, 0.72742)
bones/16/rotation = Quaternion(0.017797, 0.302208, -0.0657508, 0.950805)
bones/20/rotation = Quaternion(-0.713762, 0.123514, -0.0290156, 0.688801)
bones/21/rotation = Quaternion(-0.583677, -0.0212287, 0.00948432, 0.811653)
bones/22/rotation = Quaternion(-0.588563, -0.00394388, -0.00974716, 0.808383)
bones/27/rotation = Quaternion(-0.584471, 0.00189081, -0.0540898, 0.809608)
bones/28/rotation = Quaternion(-0.598793, 0.00760244, -0.0294114, 0.800328)
bones/29/rotation = Quaternion(0.463253, 0.610028, -0.5095, 0.39201)
bones/30/rotation = Quaternion(-0.739262, 0.494642, 0.0405374, -0.455168)

[node name="AnimationTree" parent="animationManager" index="0"]
parameters/current_position = 0.16
parameters/current_delta = 0.0133333
parameters/fight_punch/current_position = 0.16
parameters/fight_punch/current_delta = 0.0133333

[node name="navigator" type="Node3D" parent="." index="4"]
script = ExtResource("3_m6isb")

[node name="stateMachine" type="Node" parent="." index="5" node_paths=PackedStringArray("initial_state")]
script = ExtResource("3_03ql3")
initial_state = NodePath("Idle")

[node name="Defend" type="Node" parent="stateMachine" index="0"]
script = ExtResource("4_4o8ek")

[node name="Idle" type="Node" parent="stateMachine" index="1"]
script = ExtResource("6_i74hs")

[node name="Attack" type="Node" parent="stateMachine" index="2"]
script = ExtResource("9_rudlm")

[node name="navigationAgent" type="NavigationAgent3D" parent="." index="6"]
path_desired_distance = 2.0

[node name="Sprite3D" parent="hitManager" index="1"]
texture = SubResource("ViewportTexture_brdgy")

[connection signal="area_entered" from="hitNodes/hitPredictionArea" to="stateMachine/Attack" method="_on_hit_prediction_area_area_entered"]
