[gd_scene load_steps=15 format=3 uid="uid://dx3yfr7vp3gbn"]

[ext_resource type="PackedScene" uid="uid://nklwmh4e4jwg" path="res://objects/player.tscn" id="1_djgfh"]
[ext_resource type="Script" path="res://scripts/enemy/enemy.gd" id="2_mtiaa"]
[ext_resource type="Script" path="res://addons/StateMachine/state_machine.gd" id="3_03ql3"]
[ext_resource type="Script" path="res://scripts/enemy/navigator.gd" id="3_m6isb"]
[ext_resource type="Shader" uid="uid://rmua1fkabo1e" path="res://assets/Shaders/3D/bat_trail.tres" id="3_yyxms"]
[ext_resource type="Script" path="res://scripts/enemy/states/defend.gd" id="4_4o8ek"]
[ext_resource type="Texture2D" uid="uid://027637t71n23" path="res://assets/Modelos 3D/trail/trail_textura_text.png" id="4_ynvwr"]
[ext_resource type="Script" path="res://scripts/enemy/states/idle.gd" id="6_i74hs"]
[ext_resource type="Script" path="res://scripts/enemy/states/attack.gd" id="9_rudlm"]

[sub_resource type="BoxShape3D" id="BoxShape3D_p8lqk"]
size = Vector3(2.52759, 1.60049, 0.399414)

[sub_resource type="BoxShape3D" id="BoxShape3D_fsbx3"]
size = Vector3(2.18945, 1.60049, 2.20215)

[sub_resource type="BoxShape3D" id="BoxShape3D_tl0he"]
size = Vector3(1.75195, 1.60049, 0.96582)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_o7eui"]
resource_local_to_scene = true
render_priority = 0
shader = ExtResource("3_yyxms")
shader_parameter/progress = 0.0
shader_parameter/Texture = ExtResource("4_ynvwr")

[sub_resource type="ViewportTexture" id="ViewportTexture_brdgy"]
viewport_path = NodePath("hitManager/SubViewport")

[node name="Enemy" instance=ExtResource("1_djgfh")]
transform = Transform3D(6.98928, 0, 0, 0, 6.98928, 0, 0, 0, 6.98928, 0, 0, 0)
script = ExtResource("2_mtiaa")

[node name="CollisionShape3D" parent="hitNodes/hitArea" index="0"]
shape = SubResource("BoxShape3D_p8lqk")

[node name="CollisionShape3D2" parent="hitNodes/hitArea" index="1"]
shape = SubResource("BoxShape3D_fsbx3")

[node name="CollisionShape3D3" parent="hitNodes/hitArea" index="2"]
shape = SubResource("BoxShape3D_tl0he")

[node name="CollisionShape3D5" parent="hitNodes/hitArea" index="3"]
shape = SubResource("BoxShape3D_tl0he")

[node name="CollisionShape3D4" parent="hitNodes/hitArea" index="4"]
shape = SubResource("BoxShape3D_p8lqk")

[node name="hitPredictionArea" type="Area3D" parent="hitNodes" index="1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0167713, 0, 0.145831)
collision_layer = 0
collision_mask = 16

[node name="CollisionShape3D" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="0"]
transform = Transform3D(0.917164, 0, -0.398509, 0, 1, 0, 0.398509, 0, 0.917164, 0.91968, 0.812524, 0.497738)
shape = SubResource("BoxShape3D_p8lqk")

[node name="CollisionShape3D2" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="1"]
transform = Transform3D(0.999692, 0, -0.0248335, 0, 1, 0, 0.0248335, 0, 0.999692, 0.0037188, 0.812524, 0.961651)
shape = SubResource("BoxShape3D_fsbx3")

[node name="CollisionShape3D3" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="2"]
transform = Transform3D(0.651979, 0, 0.758237, 0, 1, 0, -0.758237, 0, 0.651979, -0.964785, 0.812524, 1.0705)
shape = SubResource("BoxShape3D_tl0he")

[node name="CollisionShape3D5" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="3"]
transform = Transform3D(0.65096, 0, -0.759112, 0, 1, 0, 0.759112, 0, 0.65096, 0.932687, 0.805996, 1.06904)
shape = SubResource("BoxShape3D_tl0he")

[node name="CollisionShape3D4" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="4"]
transform = Transform3D(-0.914028, 0, -0.405652, 0, 1, 0, 0.405652, 0, -0.914028, -0.936635, 0.812524, 0.524693)
shape = SubResource("BoxShape3D_p8lqk")

[node name="Trail" parent="hitNodes/hitDirection" index="0"]
material_override = SubResource("ShaderMaterial_o7eui")

[node name="Bate" parent="hitNodes" index="3"]
transform = Transform3D(10.0945, -3.97776, -20.9411, 2.88143, 23.2126, -3.02028, 21.1199, -1.26572, 10.4211, -0.496312, 0.65825, 0.332235)

[node name="Skeleton3D" parent="root" index="0"]
bones/0/position = Vector3(0.00992896, 0.911682, 0.447298)
bones/0/rotation = Quaternion(0.0260209, 0.489697, 0.0519882, 0.869953)
bones/1/rotation = Quaternion(0.54458, -0.035829, 0.814265, -0.197789)
bones/1/scale = Vector3(1, 1.05991, 1)
bones/2/rotation = Quaternion(-6.35267e-05, 7.51398e-05, 0.00251743, 0.999997)
bones/2/scale = Vector3(1.00001, 0.999987, 1)
bones/3/rotation = Quaternion(0.256588, 0.533317, -0.388399, 0.706316)
bones/3/scale = Vector3(0.995805, 0.982727, 0.969087)
bones/4/position = Vector3(0.0037105, 0.127344, -0.00822537)
bones/4/rotation = Quaternion(0.194267, 0.873555, 0.444703, -0.0374403)
bones/4/scale = Vector3(0.999772, 0.977032, 1.02269)
bones/5/rotation = Quaternion(0.933849, -0.298276, -0.193536, 0.0387397)
bones/5/scale = Vector3(0.999995, 0.999984, 1)
bones/6/position = Vector3(-1.00152e-06, 0.389355, -2.17288e-06)
bones/6/rotation = Quaternion(-5.35169e-06, -2.85384e-06, 0.354077, -0.935216)
bones/6/scale = Vector3(1.00001, 0.999992, 1)
bones/7/rotation = Quaternion(0.325956, -0.719195, 0.351845, 0.502709)
bones/7/scale = Vector3(0.999956, 0.999997, 1.00002)
bones/8/position = Vector3(-2.21777e-06, 0.127669, -7.15234e-07)
bones/8/rotation = Quaternion(-0.0473328, 0.910551, 0.410624, -0.00669742)
bones/8/scale = Vector3(1.00001, 1.00001, 0.99999)
bones/9/rotation = Quaternion(-0.00818371, -0.505969, -0.0726042, 0.859452)
bones/10/rotation = Quaternion(0.0697008, 0.309475, -0.000784758, 0.948349)
bones/11/rotation = Quaternion(0.313699, 0.00638645, 0.00211013, 0.949499)
bones/12/rotation = Quaternion(-0.25748, -0.276587, 0.124424, 0.917454)
bones/13/rotation = Quaternion(-0.524645, 0.568218, -0.44937, -0.447149)
bones/14/rotation = Quaternion(0.287013, 0.895247, -0.120297, 0.318881)
bones/15/rotation = Quaternion(0.357026, 0.0217775, 0.180641, 0.916203)
bones/15/scale = Vector3(1, 0.999669, 1)
bones/16/rotation = Quaternion(-0.024186, 0.347456, -0.10358, 0.931644)
bones/16/scale = Vector3(0.999999, 1.00033, 1)
bones/17/position = Vector3(-0.0491332, 0.0501255, -0.00465528)
bones/17/rotation = Quaternion(0.0464519, -0.786958, 0.317028, 0.527288)
bones/17/scale = Vector3(1.00002, 0.999978, 1)
bones/18/position = Vector3(-8.25216e-07, 0.0210912, 1.16751e-07)
bones/18/rotation = Quaternion(-0.0240861, -0.3065, 0.0623895, 0.949518)
bones/18/scale = Vector3(0.999986, 0.999993, 1.00002)
bones/19/rotation = Quaternion(-0.0093904, 0.438563, 0.0087935, 0.898609)
bones/19/scale = Vector3(1.00001, 1, 0.999986)
bones/20/position = Vector3(0.0245921, 0.0860819, -0.00149426)
bones/20/rotation = Quaternion(-0.714091, 0.123538, -0.0291591, 0.688449)
bones/20/scale = Vector3(1, 1, 0.999993)
bones/21/rotation = Quaternion(-0.582737, -0.0215129, 0.00939284, 0.812322)
bones/21/scale = Vector3(1, 1.00002, 0.999978)
bones/22/rotation = Quaternion(-0.589054, -0.00403399, -0.00963507, 0.808026)
bones/22/scale = Vector3(0.999999, 0.999982, 1.00002)
bones/23/position = Vector3(-0.00257248, 0.0869059, 0.000357046)
bones/23/rotation = Quaternion(-0.450202, 0.161362, -0.0363318, 0.877474)
bones/23/scale = Vector3(1.00001, 0.999966, 1.00003)
bones/24/rotation = Quaternion(-0.645683, -0.00762942, -0.0194876, 0.763319)
bones/25/rotation = Quaternion(-0.639771, -0.0177443, -0.0200695, 0.768098)
bones/26/position = Vector3(-0.0322123, 0.0834624, -0.00191512)
bones/26/rotation = Quaternion(-0.425623, 0.144413, -0.0385311, 0.892471)
bones/26/scale = Vector3(1.00001, 0.999964, 1.00003)
bones/27/rotation = Quaternion(-0.584951, 0.00188167, -0.0542404, 0.80925)
bones/27/scale = Vector3(0.999999, 1.00001, 0.999994)
bones/28/rotation = Quaternion(-0.598567, 0.00752395, -0.0292884, 0.800502)
bones/29/rotation = Quaternion(0.450003, 0.610554, -0.514803, 0.399623)
bones/30/rotation = Quaternion(-0.825331, 0.42875, 0.0243937, -0.366616)
bones/31/rotation = Quaternion(0.745281, -0.173056, -0.253622, 0.591848)
bones/31/scale = Vector3(1, 0.999766, 1)
bones/32/rotation = Quaternion(0.0449679, -0.57225, -0.0081596, 0.818805)
bones/32/scale = Vector3(1, 1.00023, 0.999999)
bones/33/rotation = Quaternion(0.0466935, 0.787048, -0.316947, 0.527181)
bones/33/scale = Vector3(1.00001, 1, 0.99999)
bones/34/rotation = Quaternion(-0.0241525, 0.306839, -0.0624016, 0.949406)
bones/35/rotation = Quaternion(-0.00929688, -0.438521, -0.00842098, 0.898633)
bones/36/rotation = Quaternion(-0.713033, -0.123518, 0.0293238, 0.689542)
bones/37/rotation = Quaternion(-0.585569, 0.02086, -0.00928149, 0.810301)
bones/38/rotation = Quaternion(-0.587469, 0.00385586, 0.0101612, 0.809174)
bones/39/rotation = Quaternion(-0.450109, -0.161218, 0.0368345, 0.877527)
bones/40/rotation = Quaternion(-0.645681, 0.00766694, 0.0197717, 0.763313)
bones/41/rotation = Quaternion(-0.639766, 0.0177638, 0.0203476, 0.768095)
bones/42/rotation = Quaternion(-0.425486, -0.144257, 0.0390133, 0.892541)
bones/43/rotation = Quaternion(-0.583492, -0.00191374, 0.0540332, 0.810317)
bones/44/rotation = Quaternion(-0.59927, -0.00776777, 0.0298951, 0.799951)

[node name="AnimationTree" parent="animationManager" index="0"]
parameters/current_position = 0.22866
parameters/current_delta = 0.0166667
parameters/fight_punch/current_position = 0.22866
parameters/fight_punch/current_delta = 0.0166667

[node name="navigator" type="Node3D" parent="." index="4"]
script = ExtResource("3_m6isb")

[node name="stateMachine" type="Node" parent="." index="5" node_paths=PackedStringArray("initial_state")]
script = ExtResource("3_03ql3")
initial_state = NodePath("Idle")

[node name="Defend" type="Node" parent="stateMachine" index="0"]
script = ExtResource("4_4o8ek")

[node name="Idle" type="Node" parent="stateMachine" index="1"]
script = ExtResource("6_i74hs")

[node name="Attack" type="Node" parent="stateMachine" index="2"]
script = ExtResource("9_rudlm")

[node name="navigationAgent" type="NavigationAgent3D" parent="." index="6"]
path_desired_distance = 2.0

[node name="Sprite3D" parent="hitManager" index="1"]
texture = SubResource("ViewportTexture_brdgy")

[connection signal="area_entered" from="hitNodes/hitPredictionArea" to="stateMachine/Defend" method="_on_hit_prediction_area_area_entered"]
