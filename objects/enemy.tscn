[gd_scene load_steps=15 format=3 uid="uid://dx3yfr7vp3gbn"]

[ext_resource type="PackedScene" uid="uid://nklwmh4e4jwg" path="res://objects/player.tscn" id="1_djgfh"]
[ext_resource type="Script" path="res://scripts/enemy/enemy.gd" id="2_mtiaa"]
[ext_resource type="Script" path="res://addons/StateMachine/state_machine.gd" id="3_03ql3"]
[ext_resource type="Script" path="res://scripts/enemy/navigator.gd" id="3_m6isb"]
[ext_resource type="Shader" uid="uid://rmua1fkabo1e" path="res://assets/Shaders/3D/bat_trail.tres" id="3_yyxms"]
[ext_resource type="Script" path="res://scripts/enemy/states/defend.gd" id="4_4o8ek"]
[ext_resource type="Texture2D" uid="uid://027637t71n23" path="res://assets/Modelos 3D/trail/trail_textura_text.png" id="4_ynvwr"]
[ext_resource type="Script" path="res://scripts/enemy/states/idle.gd" id="6_i74hs"]
[ext_resource type="Script" path="res://scripts/enemy/states/attack.gd" id="9_rudlm"]

[sub_resource type="BoxShape3D" id="BoxShape3D_p8lqk"]
size = Vector3(2.52759, 1.60049, 0.399414)

[sub_resource type="BoxShape3D" id="BoxShape3D_fsbx3"]
size = Vector3(2.18945, 1.60049, 2.20215)

[sub_resource type="BoxShape3D" id="BoxShape3D_tl0he"]
size = Vector3(1.75195, 1.60049, 0.96582)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_o7eui"]
resource_local_to_scene = true
render_priority = 0
shader = ExtResource("3_yyxms")
shader_parameter/progress = 0.0
shader_parameter/Texture = ExtResource("4_ynvwr")

[sub_resource type="ViewportTexture" id="ViewportTexture_brdgy"]
viewport_path = NodePath("hitManager/SubViewport")

[node name="Enemy" instance=ExtResource("1_djgfh")]
transform = Transform3D(6.98928, 0, 0, 0, 6.98928, 0, 0, 0, 6.98928, 0, 0, 0)
script = ExtResource("2_mtiaa")

[node name="CollisionShape3D" parent="hitNodes/hitArea" index="0"]
shape = SubResource("BoxShape3D_p8lqk")

[node name="CollisionShape3D2" parent="hitNodes/hitArea" index="1"]
shape = SubResource("BoxShape3D_fsbx3")

[node name="CollisionShape3D3" parent="hitNodes/hitArea" index="2"]
shape = SubResource("BoxShape3D_tl0he")

[node name="CollisionShape3D5" parent="hitNodes/hitArea" index="3"]
shape = SubResource("BoxShape3D_tl0he")

[node name="CollisionShape3D4" parent="hitNodes/hitArea" index="4"]
shape = SubResource("BoxShape3D_p8lqk")

[node name="hitPredictionArea" type="Area3D" parent="hitNodes" index="1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0167713, 0, 0.145831)
collision_layer = 0
collision_mask = 16

[node name="CollisionShape3D" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="0"]
transform = Transform3D(0.917164, 0, -0.398509, 0, 1, 0, 0.398509, 0, 0.917164, 0.91968, 0.812524, 0.497738)
shape = SubResource("BoxShape3D_p8lqk")

[node name="CollisionShape3D2" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="1"]
transform = Transform3D(0.999692, 0, -0.0248335, 0, 1, 0, 0.0248335, 0, 0.999692, 0.0037188, 0.812524, 0.961651)
shape = SubResource("BoxShape3D_fsbx3")

[node name="CollisionShape3D3" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="2"]
transform = Transform3D(0.651979, 0, 0.758237, 0, 1, 0, -0.758237, 0, 0.651979, -0.964785, 0.812524, 1.0705)
shape = SubResource("BoxShape3D_tl0he")

[node name="CollisionShape3D4" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="3"]
transform = Transform3D(0.65096, 0, -0.759112, 0, 1, 0, 0.759112, 0, 0.65096, 0.932687, 0.805996, 1.06904)
shape = SubResource("BoxShape3D_tl0he")

[node name="CollisionShape3D5" type="CollisionShape3D" parent="hitNodes/hitPredictionArea" index="4"]
transform = Transform3D(-0.914028, 0, -0.405652, 0, 1, 0, 0.405652, 0, -0.914028, -0.936635, 0.812524, 0.524693)
shape = SubResource("BoxShape3D_p8lqk")

[node name="Trail" parent="hitNodes/hitDirection" index="0"]
material_override = SubResource("ShaderMaterial_o7eui")

[node name="Skeleton3D" parent="root" index="0"]
bones/0/position = Vector3(-0.00730738, 0.965491, 0.255496)
bones/0/rotation = Quaternion(0.130706, 0.14469, -0.0101098, 0.980754)
bones/1/rotation = Quaternion(0.752712, 0.0995244, 0.650568, 0.0167569)
bones/1/scale = Vector3(0.999998, 1.02675, 1)
bones/2/rotation = Quaternion(-3.89395e-05, 5.43673e-05, 0.00256854, 0.999997)
bones/2/scale = Vector3(0.999999, 1, 1)
bones/3/rotation = Quaternion(0.281402, 0.531925, -0.312911, 0.734816)
bones/3/scale = Vector3(0.999298, 0.989423, 0.986062)
bones/4/position = Vector3(0.00172384, 0.12762, -0.00308564)
bones/4/rotation = Quaternion(0.103726, 0.943083, 0.314948, -0.0253676)
bones/4/scale = Vector3(1.00017, 0.987598, 1.01208)
bones/5/rotation = Quaternion(0.994146, -0.0383585, -0.0135444, 0.100094)
bones/5/scale = Vector3(0.999997, 1.00862, 0.999999)
bones/6/position = Vector3(1.54008e-06, 0.389355, 3.15617e-07)
bones/6/rotation = Quaternion(3.23881e-06, 2.1178e-05, 0.0026043, -0.999997)
bones/6/scale = Vector3(1, 1, 1)
bones/7/rotation = Quaternion(0.126725, -0.842567, 0.36812, 0.372169)
bones/7/scale = Vector3(0.999927, 0.995915, 0.995663)
bones/8/position = Vector3(-0.000885466, 0.127664, -0.000791119)
bones/8/rotation = Quaternion(-0.0580759, 0.946252, 0.318071, 0.00813723)
bones/8/scale = Vector3(1.00002, 0.995895, 1.00408)
bones/9/rotation = Quaternion(-0.121236, -0.147591, 0.0121751, 0.981514)
bones/10/rotation = Quaternion(-0.0702559, 0.00329326, 0.000231943, 0.997524)
bones/11/rotation = Quaternion(0.313699, 0.00638646, 0.0021101, 0.949499)
bones/12/rotation = Quaternion(-0.16917, -0.00666159, -0.00113573, 0.985564)
bones/13/rotation = Quaternion(-0.467322, 0.609821, -0.50793, -0.389533)
bones/14/rotation = Quaternion(0.427482, 0.522335, 0.36778, 0.639658)
bones/15/rotation = Quaternion(0.311986, 0.126369, 0.236497, 0.911463)
bones/15/scale = Vector3(1, 0.999753, 1)
bones/16/rotation = Quaternion(0.0577288, 0.282845, -0.00696539, 0.957402)
bones/16/scale = Vector3(0.999999, 1.00024, 1)
bones/17/position = Vector3(-0.0491646, 0.0500859, -0.00461843)
bones/17/rotation = Quaternion(0.0464702, -0.786923, 0.317009, 0.52735)
bones/17/scale = Vector3(1.00001, 0.999984, 1)
bones/18/position = Vector3(2.88663e-07, 0.0210911, 8.98888e-07)
bones/18/rotation = Quaternion(-0.0242228, -0.306659, 0.0625978, 0.94945)
bones/18/scale = Vector3(0.99999, 0.999995, 1.00001)
bones/19/rotation = Quaternion(-0.00920786, 0.438728, 0.00859626, 0.898532)
bones/19/scale = Vector3(1.00001, 1, 0.99999)
bones/20/position = Vector3(0.0245621, 0.0860409, -0.00147576)
bones/20/rotation = Quaternion(-0.713077, 0.123776, -0.0283918, 0.689488)
bones/20/scale = Vector3(1, 1, 0.999995)
bones/21/rotation = Quaternion(-0.585515, -0.0205621, 0.00933524, 0.810347)
bones/21/scale = Vector3(1, 1.00002, 0.999983)
bones/22/rotation = Quaternion(-0.587469, -0.00381376, -0.00984869, 0.809178)
bones/22/scale = Vector3(0.999999, 0.999987, 1.00001)
bones/23/position = Vector3(-0.00260177, 0.0868646, 0.00038214)
bones/23/rotation = Quaternion(-0.450182, 0.161463, -0.0363564, 0.877464)
bones/23/scale = Vector3(1, 0.999975, 1.00002)
bones/24/rotation = Quaternion(-0.64571, -0.00769499, -0.0194433, 0.763297)
bones/25/rotation = Quaternion(-0.639766, -0.0177411, -0.0200564, 0.768103)
bones/26/position = Vector3(-0.0322425, 0.0834219, -0.00188275)
bones/26/rotation = Quaternion(-0.425603, 0.144516, -0.0385396, 0.892464)
bones/26/scale = Vector3(1, 0.999974, 1.00002)
bones/27/rotation = Quaternion(-0.583527, 0.00193091, -0.0536865, 0.810315)
bones/27/scale = Vector3(0.999999, 1, 0.999995)
bones/28/rotation = Quaternion(-0.59928, 0.00781382, -0.029632, 0.799953)
bones/29/rotation = Quaternion(0.46739, 0.609865, -0.507782, 0.389575)
bones/30/rotation = Quaternion(-0.427501, 0.522358, 0.367645, -0.639705)
bones/31/rotation = Quaternion(0.311971, -0.126405, -0.236582, 0.911441)
bones/31/scale = Vector3(1, 0.999931, 1)
bones/32/rotation = Quaternion(0.057768, -0.282683, 0.00732747, 0.957444)
bones/32/scale = Vector3(1, 1.00007, 1)
bones/33/rotation = Quaternion(0.046703, 0.787035, -0.316929, 0.52721)
bones/33/scale = Vector3(1, 0.999995, 1)
bones/34/rotation = Quaternion(-0.0241585, 0.306849, -0.0624171, 0.949402)
bones/35/rotation = Quaternion(-0.00919865, -0.43853, -0.0083645, 0.898631)
bones/36/rotation = Quaternion(-0.713035, -0.123602, 0.0292086, 0.68953)
bones/37/rotation = Quaternion(-0.585551, 0.0207869, -0.00922037, 0.810316)
bones/39/rotation = Quaternion(-0.450104, -0.161248, 0.0368453, 0.877524)
bones/40/rotation = Quaternion(-0.645696, 0.00768163, 0.0197525, 0.763301)
bones/41/rotation = Quaternion(-0.639762, 0.0177705, 0.0203457, 0.768098)
bones/42/rotation = Quaternion(-0.425481, -0.144288, 0.0390203, 0.892538)
bones/43/rotation = Quaternion(-0.583503, -0.00190842, 0.0540069, 0.810311)
bones/44/rotation = Quaternion(-0.599265, -0.00776477, 0.0298958, 0.799954)

[node name="AnimationTree" parent="animationManager" index="0"]
parameters/current_position = 0.495931
parameters/fight_punch/current_position = 0.5
parameters/fight_punch/current_delta = 0.0225977

[node name="navigator" type="Node3D" parent="." index="4"]
script = ExtResource("3_m6isb")

[node name="stateMachine" type="Node" parent="." index="5" node_paths=PackedStringArray("initial_state")]
script = ExtResource("3_03ql3")
initial_state = NodePath("Idle")

[node name="Defend" type="Node" parent="stateMachine" index="0"]
script = ExtResource("4_4o8ek")

[node name="Idle" type="Node" parent="stateMachine" index="1"]
script = ExtResource("6_i74hs")

[node name="Attack" type="Node" parent="stateMachine" index="2"]
script = ExtResource("9_rudlm")

[node name="navigationAgent" type="NavigationAgent3D" parent="." index="6"]
path_desired_distance = 2.0

[node name="Sprite3D" parent="hitManager" index="1"]
texture = SubResource("ViewportTexture_brdgy")

[connection signal="area_entered" from="hitNodes/hitPredictionArea" to="stateMachine/Attack" method="_on_hit_prediction_area_area_entered"]
